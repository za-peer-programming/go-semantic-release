#branches:
#  - main
#  - /^stage.*$/
#  - /^dev.*$/
#  - /^feature.*$/
#  - /^bug.*$/
#  - /^hotfix.*$/

#branch:
#  - main

plugins:
  - - "@semantic-release/commit-analyzer"
    - path: '@semantic-release/commit-analyzer'
      preset: angular
      releaseRules:
        - type: break
          release: major

        - type: feature
          release: minor
        - type: feat
          release: minor

        - type: fix
          scope: fix-*
          release: patch
        - type: bug
          scope: bug-*
          release: patch
        - type: refactor
          release: patch
        - type: docs
          release: patch

        - type: ci
          release: patch
        - type: wip
          release: false
        - type: chore
          release: false
        - scope: no-release
          release: false
      parserOpts:
        noteKeywords:
          - BREAKING CHANGE
          - BREAKING CHANGES
  - - "@semantic-release/release-notes-generator"
    - types:
        - type: docs
          release: false
          section: Docs
          hidden: false
        - type: fix
          scope: fix-*
          release: patch
          section: Patch
          hidden: false
        - type: bug
          scope: bug-*
          release: patch
          section: Patch
          hidden: false
        - type: ci
          release: false
          section: CI/CD
          hidden: false
        - type: feature
          release: minor
          section: Feature
          hidden: false
        - type: feat
          release: minor
          section: Feature
          hidden: false
        - type: wip
          release: false
          section: WIP
          hidden: false
        - type: chore
          release: false
          section: Chore
          hidden: false
        - scope: no-release
          release: false
        - scope: Refactor
          release: false
          section: Refactoring
          hidden: false
      writerOpts:
        - commitGroupsSort:
            Feature
        - commitsSort:
            scope
            subject
  - "@semantic-release/changelog"
  - "@semantic-release/git"
  - "@semantic-release/github"

verifyConditions:
  - '@semantic-release/changelog'
  - '@semantic-release/git'
  - '@semantic-release/github'

# Define your versioning rules
branches:
  - name: main
  - name: "stage/*"
    prerelease: true
    channel: beta
  - name: "dev/*"
    prerelease: alpha
  - name: "feature/*"
    prerelease: "new-${name.replace(/feature\\//g, 'feat-').replace(/_/g, '-')}"
  - name: "bug/*"
    prerelease: "${name.replace(/bug\\//g, 'bug-fix-').replace(/_/g, '-')}"
  - name: "hotfix/*"
    prerelease: "${name.replace(/hotfix\\//g, 'hf-').replace(/_/g, '-')}"
  - name: "refactor/*"
    prerelease: "${name.replace(/refactor\\//g, 'rf-').replace(/_/g, '-')}"


defaultBranch: main

publish: ['@semantic-release/github']
success: ['@semantic-release/github']
fail: []

#repositoryUrl: git@github.com:za-peer-programming/go-semantic-release.git

debug: true